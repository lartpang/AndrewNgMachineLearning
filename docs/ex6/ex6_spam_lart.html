<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2018a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Machine Learning Online Class</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { text-align: left; line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 16px; white-space: pre; font-size: 12px; white-space: pre; margin-left: 55px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S4 { text-align: left; line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S6 { min-height: 18px; white-space: nowrap; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S7 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { color: rgb(160, 32, 240); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { text-align: left; line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S10 { color: rgb(64, 64, 64); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S11 { color: rgb(34, 139, 34); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { margin-left: 3px; margin-top: 4px; margin-bottom: 4px; margin-right: 3px;  }
.S13 { color: rgb(0, 0, 255); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.CodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.CodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
.outputGroup {margin: 2px 0 2px 0; padding: 2px 2px 2px 4px;}
.outputRegion {}
.outputParagraph {color: rgba(64, 64, 64, 1); padding: 10px 0 6px 17px; background: white; overflow-x: hidden;}
.inlineWrapper:last-child .outputParagraph {border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}
.outputParagraph:empty {margin: 0;}
.inlineElement .symbolicElement {margin-top: 1px; margin-bottom: 1px;}
.embeddedOutputsSymbolicElement .MathEquation {margin-top: 4px; margin-bottom: 4px;}
.embeddedOutputsSymbolicElement .MathEquation.displaySymbolicElement {margin-left: 15px;}
.embeddedOutputsSymbolicElement .MathEquation.inlineSymbolicElement {}
.embeddedOutputsSymbolicElement {overflow-x: auto; overflow-y: auto;}
.embeddedOutputsSymbolicElement { overflow: initial !important;}
.embeddedOutputsSymbolicElement { width: 100% !important; }
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement { max-height: none !important; overflow: initial !important;}
.veSpecifier {}
.veContainer {}
.veSpecifierBox {height: 400px; width: 500px;}
.veSpecifier .veTable {padding-top: 3px; padding-bottom: 4px;}
.veSpecifierBox .veSpecifier .veContainer {position: relative; width: 100%; height: 370px;}
.veSpecifierBox .dijitDialogPaneContent {width: 97% !important; height: 88% !important;}
.veSpecifier .veTable .rowHeadersWrapper {padding-bottom: 0;}
.veSpecifier .veTable .scroller .variableEditorRenderers {padding-right: 3px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;}
.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {visibility: hidden; z-index: 0;}
.veMetaSummary {font-style: italic;}
.veSpecifier .veTable .scroller {overflow: hidden;}
.veSpecifier .veTable:hover .scroller {overflow: auto;}
.veSpecifier .veVariableName,.veSpecifier .veDimensionFont {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.veSpecifier .veVariableName {padding-top: 2px;}
.veSpecifier .veDimensionFont {font-style: italic; color: #9A9A9A;}
.veSpecifier .scroller::-webkit-scrollbar-track {background-color: white;}
.veSpecifier .scroller::-webkit-scrollbar-corner {background-color: white;}
.veSpecifier .veTable .topRowHeaderWrapper {border: none; background-color: #F8F9FA;}
.veSpecifier .mw_type_ListBase.showCellBorders,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper,.veSpecifier .veTable .verticalScrollSpacer,.veSpecifier .veTable .horizontalScrollSpacer {border: none;}
.veSpecifier .veTable .dataScrollerNode {border: 1px solid #BFBFBF;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode,.veSpecifier .veTable .dataBody {font-family: Arial; font-size: 13px;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode {color: #7F7F7F;}
.veSpecifier .veTable .dataBody {color: #000000;}
.veSpecifier .veTable .columnHeaderNode .cell .drag,.veSpecifier .veTable .columnHeaderNode .cell .header,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {background-color: #F8F9FA;}
.veSpecifier .veTable .columnHeaderNode .cell .dragBorder {border-right: 1px solid #F8F9FA;}
.veSpecifier .veTable .rowHeaderNode .cell {padding-top: 3px; text-align: center; border-bottom: 1px solid #F8F9FA;}
.veSpecifier .veTable .dataBody .cell .plainText {text-align: right;}
.veSpecifier .veTable .dataBody .row .cell {border-bottom: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.embeddedOutputsVariableElement {white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.variableNameElement {margin-bottom: 3px; display: inline-block;}
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement,.eoOutputWrapper .matrixElement {min-height: 18px; box-sizing: border-box;}
.embeddedOutputsMatrixElement .matrixElement,.eoOutputWrapper .matrixElement,.rtcDataTipElement .matrixElement {position: relative;}
.matrixElement .variableValue,.rtcDataTipElement .matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer,.eoOutputWrapper .matrixElement .valueContainer,.rtcDataTipElement .matrixElement .valueContainer {white-space: nowrap; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide,.eoOutputWrapper .matrixElement .valueContainer .horizontalEllipsis.hide,.eoOutputWrapper .matrixElement .verticalEllipsis.hide,.rtcDataTipElement .matrixElement .valueContainer .horizontalEllipsis.hide,.rtcDataTipElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsVariableMatrixElement .matrixElement .valueContainer.hideEllipses .verticalEllipsis, .embeddedOutputsVariableMatrixElement .matrixElement .valueContainer.hideEllipses .horizontalEllipsis {display:none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis,.eoOutputWrapper .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.eoOutputWrapper .embeddedOutputsVariableMatrixElement .matrixElement .valueContainer {cursor: default !important;}
.matrixElement { max-height: none !important; }
.embeddedOutputsVariableTableElement .ClientViewDiv table tr {height: 22px; white-space: nowrap;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr td,.embeddedOutputsVariableTableElement .ClientViewDiv table tr th {min-width : 75px; max-width : 75px; background-color:white; text-overflow: ellipsis; font-family: 'Arial', sans-serif; font-size: 12px; overflow : hidden;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tbody tr th {width: 34px; max-width: 100px;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr span {text-overflow: ellipsis; padding: 3px;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr th {color: rgba(0,0,0,0.5); padding: 3px; font-size: 9px;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr th:first-child {min-width: 28px; max-width: 250px;}
.dijitTooltipDialog .dijitTooltipContainer .dijitTooltipContents .alertPlugin-alertMessage {min-width: 12px; max-width: 400px; max-height: 300px; overflow: auto;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar {width: 11px; height: 11px;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-track {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-corner {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {border-radius: 7px; background-color: rgba(0, 0, 0, 0.1); border: 2px solid rgba(0, 0, 0, 0); background-clip: padding-box;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.1);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.alertPlugin-alertLine {position: absolute; display: initial; width: 40px; text-align: right; cursor: text;}
.alertPlugin-onTextLine {visibility: hidden;}
.alertPlugin-hasTooltip .alertPlugin-warningImg,.alertPlugin-hasTooltip .alertPlugin-errorImg {cursor: pointer;}
.alertPlugin-alertLine .alertPlugin-warningElement,.alertPlugin-alertLine .alertPlugin-errorElement {display: inline-block; margin-right: 4px;}
.alertPlugin-isStale {-webkit-filter: opacity(0.4) grayscale(80%); filter: opacity(0.4) grayscale(80%);}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.variableNameElement .headerElement {color: rgb(179, 179, 179); font-style: italic;}
.variableNameElement .headerElement .headerDataType {color: rgb(147, 176, 230);}
.matrixElement .horizontalEllipsis,.rtcDataTipElement .matrixElement .horizontalEllipsis {display: inline-block; margin-top: 3px; width: 30px; height: 12px; background-repeat: no-repeat; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAJCAYAAADO1CeCAAAAJUlEQVR42mP4//8/A70xw0i29BUDFPxnAEtTW37wWDqakIa4pQDvOOG89lHX2gAAAABJRU5ErkJggg==");}
.matrixElement .verticalEllipsis,.textElement .verticalEllipsis,.rtcDataTipElement .matrixElement .verticalEllipsis,.rtcDataTipElement .textElement .verticalEllipsis {margin-left: 35px; width: 12px; height: 30px; background-repeat: no-repeat; background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAZCAYAAAAIcL+IAAAALklEQVR42mP4//8/AzGYgWyFMECMwv8QddRS+P//KyimlmcGUOFoOI6GI/UVAgDnd8Dd4+NCwgAAAABJRU5ErkJggg==");}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2"><span class="S0">Machine Learning Online Class</span></span></h1><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">Exercise 6 | Spam Classification with SVMs</span></span></div></div><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">Instructions</span></span></div><div class = "S0"><span class = "S0"><span class="S0">------------</span></span></div></div><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">This file contains code that helps you get started on the</span></span></div><div class = "S0"><span class = "S0"><span class="S0">exercise. You will need to complete the following functions:</span></span></div></div><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">   gaussianKernel.m</span></span></div><div class = "S0"><span class = "S0"><span class="S0">   dataset3Params.m</span></span></div><div class = "S0"><span class = "S0"><span class="S0">   processEmail.m</span></span></div><div class = "S0"><span class = "S0"><span class="S0">   emailFeatures.m</span></span></div></div><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">For this exercise, you will not need to change any code in this file,</span></span></div><div class = "S0"><span class = "S0"><span class="S0">or any other files other than those mentioned above.</span></span></div></div><h2 class = "S4"><span class = "S2"><span class="S0">Initialization</span></span></h2><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">clear ; close </span><span class="S8">all</span><span class="S0">; clc;</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S2"><span class="S0">==================== Part 1: Email Preprocessing ====================</span></span></h2><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">To use an SVM to classify emails into Spam v.s. Non-Spam, you first need</span></span></div><div class = "S0"><span class = "S0"><span class="S0">to convert each email into a vector of features. In this part, you will</span></span></div><div class = "S0"><span class = "S0"><span class="S0">implement the preprocessing steps for each email. You should</span></span></div><div class = "S0"><span class = "S0"><span class="S0">complete the code in processEmail.m to produce a word indices vector</span></span></div><div class = "S0"><span class = "S0"><span class="S0">for a given email.</span></span></div></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nPreprocessing sample email (emailSample1.txt)\n'</span><span class="S0">);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="AADB378F" data-testid="output_0" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Preprocessing sample email (emailSample1.txt)</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Extract Features</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">file_contents = readFile(</span><span class="S8">'emailSample1.txt'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">word_indices  = processEmail(file_contents);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="A81730CF" data-testid="output_1" data-width="771" data-height="129" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">==== Processed Email ====<br><br>anyon know how much it cost to host a web portal well it depend on how mani <br>visitor you re expect thi can be anywher from less than number buck a month <br>to a coupl of dollarnumb you should checkout httpaddr or perhap amazon ecnumb <br>if your run someth big to unsubscrib yourself from thi mail list send an <br>email to emailaddr <br><br>=========================</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Print Stats</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'Word Indices: \n'</span><span class="S0">);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="8A331D66" data-testid="output_2" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Word Indices: </div></div></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">' %d'</span><span class="S0">, word_indices);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="7C4CD71E" data-testid="output_3" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"> 86 916 794 1077 883 370 1699 790 1822 1831 883 431 1171 794 1002 1893 1364 592 1676 238 162 89 688 945 1663 1120 1062 1699 375 1162 479 1893 1510 799 1182 1237 810 1895 1440 1547 181 1699 1758 1896 688 1676 992 961 1477 71 530 1699 531</div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S2"><span class="S0">==================== Part 2: Feature Extraction ====================</span></span></h2><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">Now, you will convert each email into a vector of features in R^n. </span></span></div><div class = "S0"><span class = "S0"><span class="S0">You should complete the code in emailFeatures.m to produce a feature</span></span></div><div class = "S0"><span class = "S0"><span class="S0">vector for a given email.</span></span></div></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nExtracting features from sample email (emailSample1.txt)\n'</span><span class="S0">);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="A9C73692" data-testid="output_4" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Extracting features from sample email (emailSample1.txt)</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Extract Features</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">file_contents = readFile(</span><span class="S8">'emailSample1.txt'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">word_indices  = processEmail(file_contents);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="8AAD2290" data-testid="output_5" data-width="771" data-height="129" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">==== Processed Email ====<br><br>anyon know how much it cost to host a web portal well it depend on how mani <br>visitor you re expect thi can be anywher from less than number buck a month <br>to a coupl of dollarnumb you should checkout httpaddr or perhap amazon ecnumb <br>if your run someth big to unsubscrib yourself from thi mail list send an <br>email to emailaddr <br><br>=========================</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">features      = emailFeatures(word_indices);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Print Stats</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'Length of feature vector: %d\n'</span><span class="S0">, length(features));</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="FCDA656D" data-testid="output_6" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Length of feature vector: 1899</div></div></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'Number of non-zero entries: %d\n'</span><span class="S0">, sum(features &gt; 0));</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="C1DC7AE1" data-testid="output_7" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Number of non-zero entries: 45</div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S2"><span class="S0">=========== Part 3: Train Linear SVM for Spam Classification ========</span></span></h2><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">In this section, you will train a linear classifier to determine if an</span></span></div><div class = "S0"><span class = "S0"><span class="S0">email is Spam or Not-Spam.</span></span></div></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Load the Spam Email dataset</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% You will have X, y in your environment</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">load(</span><span class="S8">'spamTrain.mat'</span><span class="S0">);</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nTraining Linear SVM (Spam Classification)\n'</span><span class="S0">)</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="28F1A5F6" data-testid="output_8" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Training Linear SVM (Spam Classification)</div></div></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'(this may take 1 to 2 minutes) ...\n'</span><span class="S0">)</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="22758FD8" data-testid="output_9" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">(this may take 1 to 2 minutes) ...</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">C = 0.1;</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">model = svmTrain(X, y, C, @linearKernel);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="1C7769EE" data-testid="output_10" data-width="771" data-height="59" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Training ......................................................................<br>...............................................................................<br>...............................................................................<br>...................................................................... Done! </div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">p = svmPredict(model, X);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'Training Accuracy: %f\n'</span><span class="S0">, mean(double(p == y)) * 100);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="938C1607" data-testid="output_11" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Training Accuracy: 99.850000</div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S2"><span class="S0">=================== Part 4: Test Spam Classification ================</span></span></h2><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">After training the classifier, we can evaluate it on a test set. We have</span></span></div><div class = "S0"><span class = "S0"><span class="S0">included a test set in spamTest.mat</span></span></div></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Load the test dataset</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% You will have Xtest, ytest in your environment</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">load(</span><span class="S8">'spamTest.mat'</span><span class="S0">);</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nEvaluating the trained Linear SVM on a test set ...\n'</span><span class="S0">)</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="45BBC5FF" data-testid="output_12" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Evaluating the trained Linear SVM on a test set ...</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">p = svmPredict(model, Xtest);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'Test Accuracy: %f\n'</span><span class="S0">, mean(double(p == ytest)) * 100);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="D9477D3D" data-testid="output_13" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Test Accuracy: 98.900000</div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S2"><span class="S0">================= Part 5: Top Predictors of Spam ====================</span></span></h2><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">Since the model we are training is a linear SVM, we can inspect the</span></span></div><div class = "S0"><span class = "S0"><span class="S0">weights learned by the model to understand better how it is determining</span></span></div><div class = "S0"><span class = "S0"><span class="S0">whether an email is spam or not. The following code finds the words with</span></span></div><div class = "S0"><span class = "S0"><span class="S0">the highest weights in the classifier. Informally, the classifier</span></span></div><div class = "S0"><span class = "S0"><span class="S0">'thinks' that these words are the most likely indicators of spam.</span></span></div></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Sort the weights and obtin the vocabulary list</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">[weight, idx] = sort(model.w, </span><span class="S8">'descend'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% idx 表示wieght各元素对应在model.w中的索引值，这里是降序排列</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% 实际上这里的model.w对应的就是训练出来的最优模型中各词汇的分布情况</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">vocabList = getVocabList();</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nTop predictors of spam: \n'</span><span class="S0">);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="93B8EC12" data-testid="output_14" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Top predictors of spam: </div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S13">for </span><span class="S0">i = 1:15</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">    fprintf(</span><span class="S8">' %-15s (%f) \n'</span><span class="S0">, vocabList{idx(i)}, weight(i));</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S13">end</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="134DB5EF" data-testid="output_15" data-width="771" data-height="213" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"> our             (0.500760) <br> click           (0.466295) <br> remov           (0.422875) <br> guarante        (0.384953) <br> visit           (0.375269) <br> basenumb        (0.347268) <br> dollar          (0.329209) <br> will            (0.267070) <br> pleas           (0.262867) <br> price           (0.261988) <br> lo              (0.259476) <br> nbsp            (0.254107) <br> most            (0.251293) <br> hour            (0.241765) <br> ga              (0.238718) </div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S2"><span class="S0">=================== Part 6: Try Your Own Emails =====================</span></span></h2><div class = "S3"><div class = "S0"><span class = "S0"><span class="S0">Now that you've trained the spam classifier, you can use it on your own</span></span></div><div class = "S0"><span class = "S0"><span class="S0">emails! In the starter code, we have included spamSample1.txt,</span></span></div><div class = "S0"><span class = "S0"><span class="S0">spamSample2.txt, emailSample1.txt and emailSample2.txt as examples. </span></span></div><div class = "S0"><span class = "S0"><span class="S0">The following code reads in one of these emails and then uses your </span></span></div><div class = "S0"><span class = "S0"><span class="S0">learned SVM classifier to determine whether the email is Spam or </span></span></div><div class = "S0"><span class = "S0"><span class="S0">Not Spam</span></span></div></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Set the file to be read in (change this to spamSample2.txt,</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% emailSample1.txt or emailSample2.txt to see different predictions on</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% different emails types). Try your own emails as well!</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">filename = </span><span class="S8">'spamSample1.txt'</span><span class="S0">;</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S11">% Read and predict</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">file_contents = readFile(filename);</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">word_indices  = processEmail(file_contents);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="0C0055D2" data-testid="output_16" data-width="771" data-height="185" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">==== Processed Email ====<br><br>do you want to make dollarnumb or more per week if you ar a motiv and qualifi <br>individu i will person demonstr to you a system that will make you dollarnumb <br>number per week or more thi is not mlm call our number hour pre record number <br>to get the detail number number number i need peopl who want to make seriou <br>monei make the call and get the fact invest number minut in yourself now <br>number number number look forward to your call and i will introduc you to <br>peopl like yourself who ar current make dollarnumb number plu per week number <br>number number numberljgvnumb numberleannumberlrmsnumb <br>numberwxhonumberqiytnumb numberrjuvnumberhqcfnumb numbereidbnumberdmtvlnumb <br><br>=========================</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">x             = emailFeatures(word_indices);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">p             = svmPredict(model, x);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nProcessed %s\n\nSpam Classification: %d\n'</span><span class="S0">, filename, p);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="DB600D81" data-testid="output_17" data-width="771" data-height="45" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Processed spamSample1.txt<br><br>Spam Classification: 1</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">filename      = </span><span class="S8">'spamSample2.txt'</span><span class="S0">;</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">file_contents = readFile(filename);</span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">word_indices  = processEmail(file_contents);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="2D3EA8F8" data-testid="output_18" data-width="771" data-height="101" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">==== Processed Email ====<br><br>best bui viagra gener onlin viagra numbermg x number pill dollarnumb free <br>pill reorder discount top sell number qualiti satisfact guarante we accept <br>visa master e check payment number satisfi custom httpaddr <br><br>=========================</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">x             = emailFeatures(word_indices);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0">p             = svmPredict(model, x);</span></span></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'\nProcessed %s\n\nSpam Classification: %d\n'</span><span class="S0">, filename, p);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="938677CE" data-testid="output_19" data-width="771" data-height="45" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Processed spamSample2.txt<br><br>Spam Classification: 1</div></div></div></div><div class = 'inlineWrapper'><div class = "S6 lineNode"><span class = "S7"><span class="S0"></span></span></div></div><div class = 'inlineWrapper outputs'><div class = "S6 lineNode"><span class = "S7"><span class="S0">fprintf(</span><span class="S8">'(1 indicates spam, 0 indicates not spam)\n\n'</span><span class="S0">);</span></span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="B8B50B1E" data-testid="output_20" data-width="771" data-height="18" style="width: 801px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">(1 indicates spam, 0 indicates not spam)</div></div></div></div></div></div></div><br><!-- <br>##### SOURCE BEGIN #####<br>%% Machine Learning Online Class<br>%%<br>% <br>%  Exercise 6 | Spam Classification with SVMs<br>%<br>%%<br>% <br>%  Instructions<br>%  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH<br>%<br>%%<br>% <br>%  This file contains code that helps you get started on the<br>%  exercise. You will need to complete the following functions:<br>%<br>%%<br>% <br>%     gaussianKernel.m<br>%     dataset3Params.m<br>%     processEmail.m<br>%     emailFeatures.m<br>%<br>%%<br>% <br>%  For this exercise, you will not need to change any code in this file,<br>%  or any other files other than those mentioned above.<br>%<br>%% Initialization<br><br>clear ; close all; clc;<br>%% ==================== Part 1: Email Preprocessing ====================<br>%%<br>% <br>%  To use an SVM to classify emails into Spam v.s. Non-Spam, you first need<br>%  to convert each email into a vector of features. In this part, you will<br>%  implement the preprocessing steps for each email. You should<br>%  complete the code in processEmail.m to produce a word indices vector<br>%  for a given email.<br>%<br>%%<br>fprintf('\nPreprocessing sample email (emailSample1.txt)\n');<br><br>% Extract Features<br>file_contents = readFile('emailSample1.txt');<br>word_indices  = processEmail(file_contents);<br>% Print Stats<br>fprintf('Word Indices: \n');<br>fprintf(' %d', word_indices);<br>%% ==================== Part 2: Feature Extraction ====================<br>%%<br>% <br>%  Now, you will convert each email into a vector of features in R^n. <br>%  You should complete the code in emailFeatures.m to produce a feature<br>%  vector for a given email.<br>%<br>%%<br>fprintf('\nExtracting features from sample email (emailSample1.txt)\n');<br>% Extract Features<br>file_contents = readFile('emailSample1.txt');<br>word_indices  = processEmail(file_contents);<br>features      = emailFeatures(word_indices);<br><br>% Print Stats<br>fprintf('Length of feature vector: %d\n', length(features));<br>fprintf('Number of non-zero entries: %d\n', sum(features > 0));<br>%% =========== Part 3: Train Linear SVM for Spam Classification ========<br>%%<br>% <br>%  In this section, you will train a linear classifier to determine if an<br>%  email is Spam or Not-Spam.<br>%<br>%%<br>% Load the Spam Email dataset<br>% You will have X, y in your environment<br>load('spamTrain.mat');<br>%%<br>fprintf('\nTraining Linear SVM (Spam Classification)\n')<br>fprintf('(this may take 1 to 2 minutes) ...\n')<br>C = 0.1;<br>model = svmTrain(X, y, C, @linearKernel);<br>p = svmPredict(model, X);<br><br>fprintf('Training Accuracy: %f\n', mean(double(p == y)) * 100);<br>%% =================== Part 4: Test Spam Classification ================<br>%%<br>% <br>%  After training the classifier, we can evaluate it on a test set. We have<br>%  included a test set in spamTest.mat<br>%<br>%%<br>% Load the test dataset<br>% You will have Xtest, ytest in your environment<br>load('spamTest.mat');<br>%%<br>fprintf('\nEvaluating the trained Linear SVM on a test set ...\n')<br>p = svmPredict(model, Xtest);<br><br>fprintf('Test Accuracy: %f\n', mean(double(p == ytest)) * 100);<br>%% ================= Part 5: Top Predictors of Spam ====================<br>%%<br>% <br>%  Since the model we are training is a linear SVM, we can inspect the<br>%  weights learned by the model to understand better how it is determining<br>%  whether an email is spam or not. The following code finds the words with<br>%  the highest weights in the classifier. Informally, the classifier<br>%  'thinks' that these words are the most likely indicators of spam.<br>%<br>%%<br>% Sort the weights and obtin the vocabulary list<br>[weight, idx] = sort(model.w, 'descend');<br>% idx 表示wieght各元素对应在model.w中的索引值，这里是降序排列<br>% 实际上这里的model.w对应的就是训练出来的最优模型中各词汇的分布情况<br>vocabList = getVocabList();<br><br>fprintf('\nTop predictors of spam: \n');<br>for i = 1:15<br>    fprintf(' %-15s (%f) \n', vocabList{idx(i)}, weight(i));<br>end<br>%% =================== Part 6: Try Your Own Emails =====================<br>%%<br>% <br>%  Now that you've trained the spam classifier, you can use it on your own<br>%  emails! In the starter code, we have included spamSample1.txt,<br>%  spamSample2.txt, emailSample1.txt and emailSample2.txt as examples. <br>%  The following code reads in one of these emails and then uses your <br>%  learned SVM classifier to determine whether the email is Spam or <br>%  Not Spam<br>%<br>%%<br>% Set the file to be read in (change this to spamSample2.txt,<br>% emailSample1.txt or emailSample2.txt to see different predictions on<br>% different emails types). Try your own emails as well!<br>filename = 'spamSample1.txt';<br><br>% Read and predict<br>file_contents = readFile(filename);<br>word_indices  = processEmail(file_contents);<br>x             = emailFeatures(word_indices);<br>p             = svmPredict(model, x);<br><br>fprintf('\nProcessed %s\n\nSpam Classification: %d\n', filename, p);<br>filename      = 'spamSample2.txt';<br>file_contents = readFile(filename);<br>word_indices  = processEmail(file_contents);<br>x             = emailFeatures(word_indices);<br>p             = svmPredict(model, x);<br><br>fprintf('\nProcessed %s\n\nSpam Classification: %d\n', filename, p);<br><br>fprintf('(1 indicates spam, 0 indicates not spam)\n\n');<br>##### SOURCE END #####<br>--></body></html>